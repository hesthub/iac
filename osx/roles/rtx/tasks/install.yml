---
# Brew install stable
- name: "Install via Brew"
  community.general.homebrew:
    name: rtx
    state: present

- name: Update zshrc
  ansible.builtin.lineinfile:
    dest: "{{ lookup('env', 'HOME') }}/.zshrc"
    create: true
    mode: "0644"
    line: eval "$(rtx activate zsh)"
    regexp: ^eval "$(rtx activate zsh)"

- name: Source zshrc
  ansible.builtin.shell: source {{ lookup('env', 'HOME') }}/.zshrc && echo zshrc sourced
  args:
    executable: /usr/local/bin/zsh
  changed_when: false
